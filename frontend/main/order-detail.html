<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊàëÁöÑËÆ¢Âçï</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .page-header {
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #1890ff;
        }
        
        .page-header h1 {
            color: #1890ff;
            font-size: 24px;
            font-weight: 600;
        }
        
        /* Áä∂ÊÄÅÁ≠õÈÄâÈÄâÈ°πÂç° */
        .status-tabs {
            display: flex;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 24px;
            overflow: hidden;
        }
        
        .tab-item {
            flex: 1;
            padding: 16px 0;
            text-align: center;
            cursor: pointer;
            font-weight: 500;
            font-size: 15px;
            color: #555;
            transition: all 0.2s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-item:hover {
            background-color: #f0f7ff;
        }
        
        .tab-item.active {
            color: #1890ff;
            border-bottom: 3px solid #1890ff;
            background-color: #f0f7ff;
        }
        
        /* ËÆ¢ÂçïÂàóË°® */
        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .order-item {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            padding: 20px;
            transition: box-shadow 0.2s ease;
        }
        
        .order-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .order-info {
            flex: 1;
        }
        
        .order-number {
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
            font-size: 16px;
        }
        
        .order-time {
            color: #666;
            font-size: 14px;
        }
        
        .order-amount {
            font-weight: 600;
            color: #fa541c;
            font-size: 18px;
        }
        
        /* ËÆ¢ÂçïÁä∂ÊÄÅÊ†áÁ≠æ */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }
        
        .status-all {
            background-color: #e6f7ff;
            color: #1890ff;
        }
        
        .status-pending_payment {
            background-color: #fff7e6;
            color: #fa8c16;
        }
        
        .status-pending_accept {
            background-color: #fff1f0;
            color: #f5222d;
        }
        
        .status-delivering {
            background-color: #f6ffed;
            color: #52c41a;
        }
        
        .status-completed {
            background-color: #f6ffed;
            color: #52c41a;
        }
        
        .status-cancelled {
            background-color: #fafafa;
            color: #8c8c8c;
        }
        
        /* ÂïÜÂìÅÁÆÄË¶Å‰ø°ÊÅØ */
        .products-section {
            margin-bottom: 20px;
        }
        
        .products-section h3 {
            font-size: 15px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .products-list {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .product-item {
            display: flex;
            align-items: center;
            background-color: #fafafa;
            border-radius: 6px;
            padding: 8px 12px;
            width: calc(50% - 6px);
        }
        
        .product-image {
            width: 50px;
            height: 50px;
            border-radius: 4px;
            background-color: #e6f7ff;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1890ff;
            font-size: 12px;
        }
        
        .product-info {
            flex: 1;
        }
        
        .product-name {
            font-weight: 500;
            margin-bottom: 4px;
            color: #333;
        }
        
        .product-price {
            color: #fa541c;
            font-size: 14px;
        }
        
        /* Êìç‰ΩúÊåâÈíÆ */
        .order-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            border-top: 1px solid #f0f0f0;
            padding-top: 16px;
        }
        
        .action-btn {
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            font-size: 14px;
        }
        
        .btn-cancel {
            background-color: #fff1f0;
            color: #f5222d;
            border: 1px solid #ffa39e;
        }
        
        .btn-cancel:hover {
            background-color: #ffccc7;
        }
        
        .btn-detail {
            background-color: #e6f7ff;
            color: #1890ff;
            border: 1px solid #91d5ff;
        }
        
        .btn-detail:hover {
            background-color: #bae7ff;
        }
        
        .btn-disabled {
            background-color: #f5f5f5;
            color: #bfbfbf;
            cursor: not-allowed;
            border: 1px solid #d9d9d9;
        }
        
        /* Á©∫Áä∂ÊÄÅ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .empty-icon {
            font-size: 60px;
            color: #d9d9d9;
            margin-bottom: 20px;
        }
        
        .empty-text {
            color: #8c8c8c;
            font-size: 16px;
        }
        
        /* ÂàÜÈ°µ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 30px;
            gap: 8px;
        }
        
        .page-btn {
            padding: 8px 16px;
            background-color: white;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .page-btn:hover:not(.disabled) {
            border-color: #1890ff;
            color: #1890ff;
        }
        
        .page-btn.disabled {
            color: #bfbfbf;
            cursor: not-allowed;
        }
        
        .page-info {
            color: #666;
            font-size: 14px;
        }
        
        /* ÂèñÊ∂àËÆ¢ÂçïÊ®°ÊÄÅÊ°Ü */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            resize: vertical;
            min-height: 100px;
            font-size: 14px;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: #1890ff;
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .btn-primary {
            background-color: #1890ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .btn-primary:hover {
            background-color: #40a9ff;
        }
        
        .btn-secondary {
            background-color: #f5f5f5;
            color: #666;
            border: 1px solid #d9d9d9;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .btn-secondary:hover {
            background-color: #e6e6e6;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .status-tabs {
                flex-wrap: wrap;
            }
            
            .tab-item {
                flex: 1 0 33.333%;
                padding: 12px 0;
                font-size: 14px;
            }
            
            .product-item {
                width: 100%;
            }
            
            .order-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .order-amount {
                margin-top: 8px;
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <!-- È°µÈù¢Ê†áÈ¢ò -->
            <div class="page-header">
                <h1>ÊàëÁöÑËÆ¢Âçï</h1>
            </div>
            
            <!-- Áä∂ÊÄÅÁ≠õÈÄâÈÄâÈ°πÂç° -->
            <div class="status-tabs">
                <div 
                    v-for="tab in tabs" 
                    :key="tab.status"
                    :class="['tab-item', { active: selectedStatus === tab.status }]"
                    @click="selectStatus(tab.status)"
                >
                    {{ tab.name }}
                </div>
            </div>
            
            <!-- ËÆ¢ÂçïÂàóË°® -->
            <div v-if="orders.length > 0" class="orders-list">
                <div v-for="order in orders" :key="order.id" class="order-item">
                    <div class="order-header">
                        <div class="order-info">
                            <div class="order-number">ËÆ¢ÂçïÂè∑: {{ order.orderNumber }}</div>
                            <div class="order-time">‰∏ãÂçïÊó∂Èó¥: {{ formatTime(order.orderTime) }}</div>
                        </div>
                        <div class="order-amount">¬•{{ order.totalAmount.toFixed(2) }}</div>
                    </div>
                    
                    <div class="status-badge-container">
                        <span :class="['status-badge', getStatusClass(order.status)]">
                            {{ getStatusText(order.status) }}
                        </span>
                    </div>
                    
                    <div class="products-section">
                        <h3>ÂïÜÂìÅ‰ø°ÊÅØ</h3>
                        <div class="products-list">
                            <div v-for="product in order.products" :key="product.id" class="product-item">
                                <div class="product-image">
                                    {{ product.name.substring(0, 1) }}
                                </div>
                                <div class="product-info">
                                    <div class="product-name">{{ product.name }}</div>
                                    <div class="product-price">¬•{{ product.price.toFixed(2) }} √ó {{ product.quantity }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="order-actions">
                        <button 
                            v-if="canCancel(order)"
                            @click="openCancelModal(order)"
                            class="action-btn btn-cancel"
                        >
                            ÂèñÊ∂àËÆ¢Âçï
                        </button>
                        <button 
                            v-else
                            class="action-btn btn-disabled"
                            disabled
                        >
                            Êó†Ê≥ïÂèñÊ∂à
                        </button>
                        <button class="action-btn btn-detail" @click="viewOrderDetail(order)">
                            Êü•ÁúãËØ¶ÊÉÖ
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Á©∫Áä∂ÊÄÅ -->
            <div v-else class="empty-state">
                <div class="empty-icon">üì¶</div>
                <div class="empty-text">ÊöÇÊó†ËÆ¢ÂçïËÆ∞ÂΩï</div>
            </div>
            
            <!-- ÂàÜÈ°µ -->
            <div v-if="totalPages > 1" class="pagination">
                <button 
                    class="page-btn" 
                    :class="{ disabled: currentPage === 0 }"
                    @click="changePage(currentPage - 1)"
                    :disabled="currentPage === 0"
                >
                    ‰∏ä‰∏ÄÈ°µ
                </button>
                <span class="page-info">Á¨¨ {{ currentPage + 1 }} È°µ / ÂÖ± {{ totalPages }} È°µ</span>
                <button 
                    class="page-btn" 
                    :class="{ disabled: currentPage === totalPages - 1 }"
                    @click="changePage(currentPage + 1)"
                    :disabled="currentPage === totalPages - 1"
                >
                    ‰∏ã‰∏ÄÈ°µ
                </button>
            </div>
            
            <!-- ÂèñÊ∂àËÆ¢ÂçïÊ®°ÊÄÅÊ°Ü -->
            <div v-if="showCancelModal" class="modal-overlay">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-title">ÂèñÊ∂àËÆ¢Âçï</div>
                        <button class="modal-close" @click="closeCancelModal">√ó</button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ÂèñÊ∂àÂéüÂõ†:</label>
                        <textarea 
                            v-model="cancelReason" 
                            class="form-textarea" 
                            placeholder="ËØ∑ËæìÂÖ•ÂèñÊ∂àËÆ¢ÂçïÁöÑÂéüÂõ†..."
                        ></textarea>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="btn-secondary" @click="closeCancelModal">ÂèñÊ∂à</button>
                        <button class="btn-primary" @click="confirmCancelOrder">Á°ÆËÆ§ÂèñÊ∂à</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        new Vue({
            el: '#app',
            data() {
                return {
                    // ËÆ¢ÂçïÁä∂ÊÄÅÈÄâÈ°πÂç°
                    tabs: [
                        { status: 'all', name: 'ÂÖ®ÈÉ®' },
                        { status: 'pending_payment', name: 'ÂæÖÊîØ‰ªò' },
                        { status: 'pending_accept', name: 'ÂæÖÊé•Âçï' },
                        { status: 'delivering', name: 'ÈÖçÈÄÅ‰∏≠' },
                        { status: 'completed', name: 'Â∑≤ÂÆåÊàê' },
                        { status: 'cancelled', name: 'Â∑≤ÂèñÊ∂à' }
                    ],
                    selectedStatus: 'all',
                    
                    // ËÆ¢ÂçïÊï∞ÊçÆ
                    orders: [],
                    
                    // ÂàÜÈ°µ‰ø°ÊÅØ
                    currentPage: 0,
                    pageSize: 5,
                    totalPages: 1,
                    
                    // ÂèñÊ∂àËÆ¢ÂçïÊ®°ÊÄÅÊ°Ü
                    showCancelModal: false,
                    cancelReason: '',
                    cancelingOrder: null
                };
            },
            created() {
                // Ê®°ÊãüÂä†ËΩΩËÆ¢ÂçïÊï∞ÊçÆ
                this.loadOrders();
            },
            methods: {
                // ÈÄâÊã©ËÆ¢ÂçïÁä∂ÊÄÅ
                selectStatus(status) {
                    this.selectedStatus = status;
                    this.currentPage = 0;
                    this.loadOrders();
                },
                
                // Âä†ËΩΩËÆ¢ÂçïÊï∞ÊçÆÔºàÊ®°ÊãüAPIË∞ÉÁî®Ôºâ
                loadOrders() {
                    // Ê®°ÊãüAPIËØ∑Ê±ÇÂª∂Ëøü
                    setTimeout(() => {
                        // Ê®°ÊãüËÆ¢ÂçïÊï∞ÊçÆ
                        const mockOrders = this.generateMockOrders();
                        
                        // Ê†πÊçÆÁä∂ÊÄÅÁ≠õÈÄâ
                        let filteredOrders = mockOrders;
                        if (this.selectedStatus !== 'all') {
                            filteredOrders = mockOrders.filter(order => order.status === this.selectedStatus);
                        }
                        
                        // Ê®°ÊãüÂàÜÈ°µ
                        const startIndex = this.currentPage * this.pageSize;
                        const endIndex = startIndex + this.pageSize;
                        this.orders = filteredOrders.slice(startIndex, endIndex);
                        
                        // ËÆ°ÁÆóÊÄªÈ°µÊï∞
                        this.totalPages = Math.ceil(filteredOrders.length / this.pageSize);
                    }, 300);
                },
                
                // ÁîüÊàêÊ®°ÊãüËÆ¢ÂçïÊï∞ÊçÆ
                generateMockOrders() {
                    const statuses = ['pending_payment', 'pending_accept', 'delivering', 'completed', 'cancelled'];
                    const orderNumbers = ['ORD20230520001', 'ORD20230519002', 'ORD20230518003', 'ORD20230517004', 'ORD20230516005', 'ORD20230515006', 'ORD20230514007', 'ORD20230513008', 'ORD20230512009', 'ORD20230511010'];
                    
                    const products = [
                        { id: 1, name: 'ÁâõËÇâÊ±âÂ†°Â•óÈ§ê', price: 32.5, quantity: 1 },
                        { id: 2, name: 'È¶ôËæ£È∏°ÁøÖÔºà6‰∏™Ôºâ', price: 18.0, quantity: 1 },
                        { id: 3, name: 'ÁªèÂÖ∏ÂíñÂï°', price: 15.0, quantity: 2 },
                        { id: 4, name: 'Ëî¨ËèúÊ≤ôÊãâ', price: 12.5, quantity: 1 },
                        { id: 5, name: 'ËñØÊù°ÔºàÂ§ß‰ªΩÔºâ', price: 10.0, quantity: 1 },
                        { id: 6, name: 'ÂÜ∞Ê∑áÊ∑ãÂú£‰ª£', price: 8.0, quantity: 1 }
                    ];
                    
                    return orderNumbers.map((orderNumber, index) => {
                        // ÈöèÊú∫ÈÄâÊã©2-3‰∏™ÂïÜÂìÅ
                        const productCount = Math.floor(Math.random() * 2) + 2;
                        const orderProducts = [];
                        const usedIndices = new Set();
                        
                        for (let i = 0; i < productCount; i++) {
                            let productIndex;
                            do {
                                productIndex = Math.floor(Math.random() * products.length);
                            } while (usedIndices.has(productIndex));
                            
                            usedIndices.add(productIndex);
                            orderProducts.push({...products[productIndex]});
                        }
                        
                        // ËÆ°ÁÆóÊÄªÈáëÈ¢ù
                        const totalAmount = orderProducts.reduce((sum, product) => sum + product.price * product.quantity, 0);
                        
                        // Ê®°ÊãüÊó∂Èó¥ÂÄíÂ∫èÔºàÊúÄÊñ∞ÁöÑËÆ¢ÂçïÂú®ÂâçÈù¢Ôºâ
                        const daysAgo = index;
                        const orderTime = new Date();
                        orderTime.setDate(orderTime.getDate() - daysAgo);
                        
                        return {
                            id: index + 1,
                            orderNumber: orderNumber,
                            orderTime: orderTime.toISOString(),
                            totalAmount: totalAmount,
                            status: statuses[index % statuses.length],
                            products: orderProducts
                        };
                    }).sort((a, b) => new Date(b.orderTime) - new Date(a.orderTime)); // Êó∂Èó¥ÂÄíÂ∫è
                },
                
                // Ê†ºÂºèÂåñÊó∂Èó¥
                formatTime(timeStr) {
                    const date = new Date(timeStr);
                    return `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                },
                
                // Ëé∑ÂèñÁä∂ÊÄÅÊñáÊú¨
                getStatusText(status) {
                    const statusMap = {
                        'pending_payment': 'ÂæÖÊîØ‰ªò',
                        'pending_accept': 'ÂæÖÊé•Âçï',
                        'delivering': 'ÈÖçÈÄÅ‰∏≠',
                        'completed': 'Â∑≤ÂÆåÊàê',
                        'cancelled': 'Â∑≤ÂèñÊ∂à'
                    };
                    return statusMap[status] || status;
                },
                
                // Ëé∑ÂèñÁä∂ÊÄÅÊ†∑ÂºèÁ±ª
                getStatusClass(status) {
                    return `status-${status}`;
                },
                
                // Âà§Êñ≠ËÆ¢ÂçïÊòØÂê¶ÂèØ‰ª•ÂèñÊ∂à
                canCancel(order) {
                    // Âè™ÊúâÂæÖÊîØ‰ªòÂíåÂæÖÊé•ÂçïÁöÑËÆ¢ÂçïÂèØ‰ª•ÂèñÊ∂à
                    return order.status === 'pending_payment' || order.status === 'pending_accept';
                },
                
                // ÊâìÂºÄÂèñÊ∂àËÆ¢ÂçïÊ®°ÊÄÅÊ°Ü
                openCancelModal(order) {
                    this.cancelingOrder = order;
                    this.cancelReason = '';
                    this.showCancelModal = true;
                },
                
                // ÂÖ≥Èó≠ÂèñÊ∂àËÆ¢ÂçïÊ®°ÊÄÅÊ°Ü
                closeCancelModal() {
                    this.showCancelModal = false;
                    this.cancelingOrder = null;
                    this.cancelReason = '';
                },
                
                // Á°ÆËÆ§ÂèñÊ∂àËÆ¢ÂçïÔºàÊ®°ÊãüAPIË∞ÉÁî®Ôºâ
                confirmCancelOrder() {
                    if (!this.cancelReason.trim()) {
                        alert('ËØ∑ËæìÂÖ•ÂèñÊ∂àÂéüÂõ†');
                        return;
                    }
                    
                    // Ê®°ÊãüAPIËØ∑Ê±Ç
                    setTimeout(() => {
                        // Âú®ÂÆûÈôÖÂ∫îÁî®‰∏≠ÔºåËøôÈáå‰ºöË∞ÉÁî® POST /api/orders/{id}/cancel
                        // ËØ∑Ê±Ç‰ΩìÔºö{ "reason": this.cancelReason }
                        
                        // Êõ¥Êñ∞ËÆ¢ÂçïÁä∂ÊÄÅ
                        this.orders = this.orders.map(order => {
                            if (order.id === this.cancelingOrder.id) {
                                return { ...order, status: 'cancelled' };
                            }
                            return order;
                        });
                        
                        alert(`ËÆ¢Âçï ${this.cancelingOrder.orderNumber} Â∑≤ÂèñÊ∂à`);
                        this.closeCancelModal();
                    }, 500);
                },
                
                // Êü•ÁúãËÆ¢ÂçïËØ¶ÊÉÖ
                viewOrderDetail(order) {
                    alert(`Êü•ÁúãËÆ¢ÂçïËØ¶ÊÉÖ: ${order.orderNumber}\nÁä∂ÊÄÅ: ${this.getStatusText(order.status)}\nÈáëÈ¢ù: ¬•${order.totalAmount.toFixed(2)}\nÂïÜÂìÅÊï∞Èáè: ${order.products.length}‰ª∂`);
                },
                
                // ÂàáÊç¢ÂàÜÈ°µ
                changePage(page) {
                    if (page >= 0 && page < this.totalPages) {
                        this.currentPage = page;
                        this.loadOrders();
                    }
                }
            }
        });
    </script>
</body>
</html>